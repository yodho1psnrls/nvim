cmake_minimum_required(VERSION 3.25)
set(CMAKE_CXX_STANDARD 20)
set(CMAKE_CXX_STANDARD_REQUIRED ON)

# Ensure that compile_commands.json is generated by CMake
set(CMAKE_EXPORT_COMPILE_COMMANDS ON)

project(proj)


# Link-Time Optimization allows the compiler to perform
#  optimizations across the entire program, which can reduce
#  the final binary size and improve runtime. While it increases
#  the initial compilation time, it can potentially reduce link
#  times and increase the speed of your application at runtime
#set(CMAKE_INTERPROCEDURAL_OPTIMIZATION TRUE)


# Ensure build type is Debug if not specified
#if(NOT CMAKE_BUILD_TYPE)
#    set(CMAKE_BUILD_TYPE Debug)
#endif()

# Set compiler flags for Debug builds
set(CMAKE_C_FLAGS_DEBUG "-g -O0")
set(CMAKE_CXX_FLAGS_DEBUG "-g -O0")

#set(CMAKE_C_FLAGS_DEBUG "${CMAKE_C_FLAGS_DEBUG} -g -O0")
#set(CMAKE_CXX_FLAGS_DEBUG "${CMAKE_CXX_FLAGS_DEBUG} -g -O0")

# Maybe also add -s or -strip
set(CMAKE_C_FLAGS_RELEASE "-O3 -DNDEBUG")
set(CMAKE_CXX_FLAGS_RELEASE "-O3 -DNDEBUG")


# Set the output directories for all configurations
set(CMAKE_RUNTIME_OUTPUT_DIRECTORY ${CMAKE_BINARY_DIR}/bin)
set(CMAKE_RUNTIME_OUTPUT_DIRECTORY_DEBUG ${CMAKE_BINARY_DIR}/bin)
set(CMAKE_RUNTIME_OUTPUT_DIRECTORY_RELEASE ${CMAKE_BINARY_DIR}/bin)

# Optional: Set for libraries and archives
set(CMAKE_ARCHIVE_OUTPUT_DIRECTORY ${CMAKE_BINARY_DIR}/lib)
set(CMAKE_LIBRARY_OUTPUT_DIRECTORY ${CMAKE_BINARY_DIR}/lib)


# Include the external libraries
set(EXTERNAL_LIB_DIR "D:/libraries")
include_directories(${EXTERNAL_LIB_DIR}/include)
link_directories(${EXTERNAL_LIB_DIR}/lib)

# Add the src directory (which contains the rest of the project structure)
add_subdirectory(src)

# Add glad.c as an external source file to the existing `proj` target
target_sources(proj PRIVATE ${EXTERNAL_LIB_DIR}/src/glad/glad.c)
# Use `GL` for Linux or `opengl32` for Windows
target_link_libraries(proj glfw3 opengl32)
